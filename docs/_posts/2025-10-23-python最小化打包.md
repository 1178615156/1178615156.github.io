---
layout: post
---

# 2025-10-23-python最小化打包


1. 使用slim镜像
```Dockerfile
FROM python:3.11-slim-bullseye
ENV LC_ALL=en_US.UTF-8 \
    LANG=en_US.UTF-8 \
    LANGUAGE=en_US.UTF-8 \
    TZ=Asia/Shanghai \
    HOST=0.0.0.0 \
    PYTHONDONTWRITEBYTECODE=1 \
    PYTHONUNBUFFERED=1
```

2. pip安装的时候加上`--no-cache-dir --no-compile`
```Dockerfile
RUN pip install --no-cache-dir --no-compile --prefer-binary \
    pandas numpy
```

3. 很多依赖会把测试代码和用例打包进去,安装的时候可以删掉

```Dockerfile
RUN pip install --no-cache-dir --no-compile --prefer-binary \
    pandas numpy  \
    && rm -rf /usr/local/lib/python3.11/site-packages/pandas/tests
```


## 完整版
```Dockerfile
FROM python:3.11-slim-bullseye
ENV LC_ALL=en_US.UTF-8 \
    LANG=en_US.UTF-8 \
    LANGUAGE=en_US.UTF-8 \
    TZ=Asia/Shanghai \
    HOST=0.0.0.0 \
    PYTHONDONTWRITEBYTECODE=1 \
    PYTHONUNBUFFERED=1

RUN pip install --no-cache-dir --no-compile --prefer-binary \
    pandas numpy  \
    && rm -rf /usr/local/lib/python3.11/site-packages/pandas/tests

# ......

```